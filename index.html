<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.34.0">
<meta name="crystal_docs.project_version" content="main">
<meta name="crystal_docs.project_name" content="snowpacker">


<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>

  <meta id="repository-name" content="snowpacker">
  <title>snowpacker main</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          snowpacker
        </a>
      </h1>

      <span class="project-version">
        main
      </span>
    </div>
  </div>

  <div class="search-results" class="hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="snowpacker/Snowpacker" data-name="snowpacker">
      <a href="Snowpacker.html">Snowpacker</a>
      
        <ul>
  
  <li class=" " data-id="snowpacker/Snowpacker/Configuration" data-name="snowpacker::configuration">
      <a href="Snowpacker/Configuration.html">Configuration</a>
      
    </li>
  
  <li class=" " data-id="snowpacker/Snowpacker/Engine" data-name="snowpacker::engine">
      <a href="Snowpacker/Engine.html">Engine</a>
      
    </li>
  
  <li class="parent " data-id="snowpacker/Snowpacker/Ext" data-name="snowpacker::ext">
      <a href="Snowpacker/Ext.html">Ext</a>
      
        <ul>
  
  <li class="parent " data-id="snowpacker/Snowpacker/Ext/Athena" data-name="snowpacker::ext::athena">
      <a href="Snowpacker/Ext/Athena.html">Athena</a>
      
        <ul>
  
  <li class=" " data-id="snowpacker/Snowpacker/Ext/Athena/StaticFileListener" data-name="snowpacker::ext::athena::staticfilelistener">
      <a href="Snowpacker/Ext/Athena/StaticFileListener.html">StaticFileListener</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="snowpacker.cr" class="anchor" href="#snowpacker.cr">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Snowpacker.cr</h1>

<p>Snowpacker.cr wraps around <a href="https://www.snowpack.dev" target="_blank">Snowpack</a> and turns on the Snowpack dev server when enabled. This shard really just forgos the need to run Snowpack in a separate terminal. Along with that, it has a few extensions so you can integrate it with your preferred framework without having to manually set up the proxying.</p>

<h1><a id="docs" class="anchor" href="#docs">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Docs</h1>

<p><a href="https://andrewc910.github.io/snowpacker.cr/index.html" target="_blank">API Docs</a></p>

<h1><a id="guide" class="anchor" href="#guide">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Guide</h1>

<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>

<pre><code class="language-yml">dependencies:
  snowpacker:
    github: andrewc910/snowpacker.cr
    version: ~> 0.1.0</code></pre>

<h2><a id="configuration" class="anchor" href="#configuration">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Configuration</h2>

<p><code>snowpack.config.js</code></p>

<p>This file typically goes in the root directory of your project, however snowpacker.cr passes in the file path via the snowpack cli. You can put this anywhere if you set the configuration <code>config_path</code>.</p>

<pre><code class="language-js">// Snowpack Configuration File
// See all supported options: https://www.snowpack.dev/reference/configuration

/** @type {import("snowpack").SnowpackUserConfig } */
module.exports = {
  // Files that will be exluded from loading & watching.
  exclude: ["**/node_modules/**/*", "**/lib/**/*"],
  /**
   * Files that will be mounted to Snowpacks dev server. Change the key to the folder(s)
   * that contain your static assets.
   */
  mount: {
    "src/assets": { url: "/" },
  },
  plugins: [
    /* ... */
  ],
  packageOptions: {
    /* ... */
  },
  devOptions: {
    output: "stream", // dont clear terminal
    open: "none", // dont open a web page when the server turns on
    hmr: true, // Enables hot module reloading
  },
  buildOptions: {
    out: "public/dist", // The folder assets will be written to after building
  },
};</code></pre>

<p><code>snowpacker.cr</code></p>

<p>This file can go anywhere. For most frameworks, it would be an <strong>initializer</strong>.</p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;snowpacker&quot;</span>

<span class="t">Snowpacker</span><span class="t">::</span><span class="t">Engine</span>.configure <span class="k">do</span> <span class="o">|</span>config<span class="o">|</span>
  <span class="c"># If the dev server &amp; extension middleware should be enabled. Ensure this is `true` when you</span>
  <span class="c"># want the dev server to run. Set `false` in production.</span>
  config.enabled <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;MY_SERVER_ENV&quot;</span>]? <span class="o">==</span> <span class="s">&quot;development&quot;</span>

  <span class="c"># The path `snowpack.config.js` will be loaded from.</span>
  <span class="c"># config.config_path = Dir.current</span>

  <span class="c"># The port requests will be redirected too. This does NOT change the port snowpack actually runs on.</span>
  <span class="c"># Make sure this matches the port in your `snowpack.config.js` file. Snowpack defaults to `8080`.</span>
  <span class="c"># config.port = 8080</span>

  <span class="c"># The hostname requests will be redirected too. This does NOT change the hostname snowpack actually</span>
  <span class="c"># runs on. Make sure this matches the hostname in your `snowpack.config.js` file.</span>
  <span class="c"># Snowpack defaults to `localhost`.</span>
  <span class="c"># config.hostname = &quot;localhost&quot;</span>

  <span class="c"># The `NODE_ENV` that will be prepended to the command starting the snowpack dev server. This can</span>
  <span class="c"># be overwritten via Crystal&#39;s environment variables with `ENV[&quot;NODE_ENV&quot;] = &quot;my_env&quot;` if you</span>
  <span class="c"># would prefer.</span>
  <span class="c">#</span>
  <span class="c"># Crystal nor Node can access environment variables outside of their process for safety reasons.</span>
  <span class="c"># Because of this, snowpacker.cr prepends the env to the command.</span>
  <span class="c">#</span>
  <span class="c"># Example: `&quot;NODE_ENV=#{Snowpacker.config.node_env} npx snowpack #{cmd}&quot;</span>
  <span class="c"># config.node_env = &quot;development&quot;</span>

  <span class="c"># The regex snowpacker.cr uses to match assets. If a request matches this, the request will be</span>
  <span class="c"># redirected to snowpacks dev server. The default regex should be fine for most use cases but</span>
  <span class="c"># this configuration is exposed for advanced use cases.</span>
  <span class="c"># config.asset_regex = /.(css|scss|sass|less|js|ts|jsx|tsx|ico|jpg|jpeg|png|webp|svg)/</span>
<span class="k">end</span>

<span class="c"># Starts a new process in the background. This is safe to leave as is. If `Snowpacker.config.enabled`</span>
<span class="c"># returns `false`, the dev server will not turn on regardless if this method is invoked or not.</span>
<span class="t">Snowpacker</span><span class="t">::</span><span class="t">Engine</span>.run</code></pre>

<h2><a id="framework-support" class="anchor" href="#framework-support">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Framework Support</h2>

<p>Snowpacker is designed to be framework agnostic. You will have to write your own middleware to redirect requests to the dev server. However, Snowpacker comes with a few extensions to make your life easier.</p>

<blockquote>Note: These extensions do NOT serve static files when the snowpack server is turned off. The extensions only handle redirecting requests when the server is enabled. You will still need a piece of middleware to fetch static assets in production. Ensure the snowpacker's middleware is invoked prior to your static file handling middleware in development.</blockquote>

<h3><a id="amber" class="anchor" href="#amber">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Amber</h3>

<p><span class="flag orange">TODO</span> </p>

<h3><a id="athena" class="anchor" href="#athena">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Athena</h3>

<p>In your <code>snowpacker.cr</code> file, add <code>require "snowpacker/ext/athena"</code> below <code>require "snowpacker"</code>.</p>

<p>Snowpacker's Athena extension works off of Athena's event listener system. It listens on the request phase and will return an <code>ART::Response</code> object, short circuiting the rest of the listeners, when a file match is found. The default priorty is <code>200</code>. This extension exposes another configuration setting <code>athena_listener_priority</code>. You can set this to a custom value if you require.</p>

<h3><a id="lucky" class="anchor" href="#lucky">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Lucky</h3>

<p><span class="flag orange">TODO</span> </p>

<h1><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h1>

<p>Fork it (https://github.com/andrewc910/snowpacker.cr/fork)
Create your feature branch (git checkout -b my-new-feature)
Commit your changes (git commit -am 'Add some feature'), also run bin/ameba
Push to the branch (git push origin my-new-feature)
Create a new Pull Request
Don't forget to add proper tests, if possible</p>

<h1><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h1>

<ul><li><a href="https://github.com/andrewc910" target="_blank">Andrew Crotwell</a> - creator & maintainer</li></ul>
</div>
</body>
</html>
